{"version":3,"file":"ClipAndFile.min.js","sources":["ClipAndFile.js"],"names":["window","undefined","_currentElement","_window","_document","document","_navigator","navigator","_setTimeout","setTimeout","_parseInt","Number","parseInt","_parseFloat","parseFloat","_isNaN","isNaN","_encodeURIComponent","encodeURIComponent","_Math","Math","_Date","Date","_ActiveXObject","ActiveXObject","_slice","Array","prototype","slice","_keys","Object","keys","_hasOwn","hasOwnProperty","_defineProperty","defineProperty","x","value","y","e","_args","argumentsObj","call","_inArray","item","array","fromIndex","indexOf","i","len","length","_extend","arg","prop","src","copy","args","arguments","target","_deepCopy","source","_pick","obj","newObj","_omit","_objectKeys","push","_deleteOwnProperties","_makeReadOnly","writable","configurable","enumerable","_now","time","now","getTime","_containedBy","el","ancestorEl","nodeType","parentNode","_flashState","bridge","version","pluginType","disabled","outdated","unavailable","deactivated","overdue","ready","_minimumFlashVersion","_handlers","_clipData","_fileData","_clipDataFormatMap","_eventMessages","error","flash-disabled","flash-outdated","flash-unavailable","flash-deactivated","flash-overdue","_swfPath","jsDir","tmpJsPath","jsPath","swfPath","currentScript","scripts","getElementsByTagName","readyState","split","lastIndexOf","_globalConfig","trustedDomains","location","host","cacheBust","forceEnhancedClipboard","flashLoadTimeout","autoActivate","bubbleEvents","containerId","containerClass","swfObjectId","hoverClass","activeClass","forceHandCursor","title","zIndex","_config","options","test","_isValidHtml4Id","Error","_state","browser","flash","clipandfile","ClipAndFile","config","_isFlashUnusable","_on","eventType","listener","events","added","toLowerCase","on","replace","emit","type","errorTypes","name","_off","foundIndex","perEventHandlers","off","splice","_listeners","_emit","event","eventCopy","returnVal","tmp","_createEvent","_preprocessEvent","_dispatchCallbacks","this","_mapClipDataToFlash","data","formatMap","_create","isFlashUnusable","maxWait","_embedSwf","_destroy","clearData","deactivate","_unembedSwf","_setData","format","dataObj","dataFormat","_setFile","filename","b64","file","_clearData","_activate","element","_removeClass","_addClass","newTitle","getAttribute","htmlBridge","_getHtmlBridge","setAttribute","useHandCursor","_getStyle","_setHandCursor","_reposition","_deactivate","removeAttribute","style","left","top","width","id","relatedTarget","currentTarget","timeStamp","msg","message","minimumVersion","clipboardData","setData","setFile","_mapClipResultsFromFlash","_getRelatedTarget","_addMouseData","targetEl","relatedTargetId","getElementById","srcElement","fromElement","toElement","pos","_getDOMObjectPosition","screenLeft","screenX","screenTop","screenY","scrollLeft","body","documentElement","scrollTop","pageX","_stageX","pageY","_stageY","clientX","clientY","moveX","movementX","moveY","movementY","offsetX","offsetY","layerX","layerY","_shouldPerformAsync","_dispatchCallback","func","context","async","apply","wildcardTypeHandlers","specificTypeHandlers","handlers","concat","originalContext","handleEvent","_preprocessCopyEvent","textContent","htmlContent","innerText","outerHTML","innerHTML","sourceIsSwf","_source","wasDeactivated","_safeActiveElement","focus","activate","_fireMouseEvent","bubbles","cancelable","doc","ownerDocument","defaults","view","defaultView","canBubble","detail","button","which","createEvent","dispatchEvent","ctrlKey","altKey","shiftKey","metaKey","initMouseEvent","createEventObject","fireEvent","_createHtmlBridge","container","createElement","className","position","height","_getSafeZIndex","flashBridge","nodeName","allowScriptAccess","_determineScriptAccess","allowNetworking","flashvars","_vars","swfUrl","_cacheBust","divToBeReplaced","appendChild","tmpDiv","oldIE","firstChild","replaceChild","display","removeSwfFromIE","removeChild","clipData","fileData","newClipData","text","html","rtf","clipResults","newResults","tmpHash","path","domain","domains","str","trustedOriginsExpanded","_extractDomain","protocol","join","originOrUrl","protocolIndex","pathIndex","_extractAllDomains","origins","resultsArray","currentDomain","configOptions","swfDomain","trustedOrigins","activeElement","err","classList","contains","add","classNames","setClass","c","cl","remove","_camelizeCssPropName","matcherRegex","replacerFn","match","group","toUpperCase","camelProp","tagName","getComputedStyle","getPropertyValue","currentStyle","_getZoomFactor","rect","physicalWidth","logicalWidth","zoomFactor","getBoundingClientRect","right","offsetWidth","round","info","pageXOffset","pageYOffset","leftBorderWidth","clientLeft","topBorderWidth","clientTop","bottom","enabled","setHandCursor","val","_detectFlashSupport","parseFlashVersion","desc","matches","isPepperFlash","flashPlayerFileName","inspectPlugin","plugin","hasFlash","flashVersion","description","isPPAPI","ax","mimeType","isActiveX","plugins","mimeTypes","enabledPlugin","GetVariable","e1","e2","e3","_createClient","state","create","destroy","_clientIdCounter","_clientMeta","_elementIdCounter","_elementMeta","_mouseHandlers","_clientConstructor","elements","client","instance","clip","_clientOn","_clientOff","_clientListeners","_clientEmit","_clientShouldEmit","_clientDispatchCallbacks","_clientClip","_prepClip","cafClippingId","_addMouseHandlers","clippedElements","_clientUnclip","meta","arrayIndex","clientIds","_removeMouseHandlers","_clientElements","_clientDestroy","unclip","clippedEls","hasClippedEls","goodTarget","goodRelTarget","goodClient","_addEventHandler","method","addEventListener","attachEvent","_removeEventHandler","removeEventListener","detachEvent","_elementMouseOver","mouseover","mouseHandlers","setText","setHtml","setRichText","richText","define","amd","module","exports"],"mappings":"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","sourcesContent":["/*!\r\n * ClipAndFile\r\n * The ClipAndFile library provides an easy way to copy text to the clipboard or save a file using an invisible Adobe Flash movie and a JavaScript interface.\r\n * Copyright (c) 2015 Jon Rohan, James M. Greene, Jeremy Gore\r\n * Licensed MIT\r\n * https://github.com/jmgore75/clipandfile\r\n * v0.1.0\r\n */\n(function(window, undefined) {\n  \"use strict\";\n  /**\r\n * Store references to critically important global functions that may be\r\n * overridden on certain web pages.\r\n */\n  var _window = window, _document = _window.document, _navigator = _window.navigator, _setTimeout = _window.setTimeout, _parseInt = _window.Number.parseInt || _window.parseInt, _parseFloat = _window.Number.parseFloat || _window.parseFloat, _isNaN = _window.Number.isNaN || _window.isNaN, _encodeURIComponent = _window.encodeURIComponent, _Math = _window.Math, _Date = _window.Date, _ActiveXObject = _window.ActiveXObject, _slice = _window.Array.prototype.slice, _keys = _window.Object.keys, _hasOwn = _window.Object.prototype.hasOwnProperty, _defineProperty = function() {\n    if (typeof _window.Object.defineProperty === \"function\" && function() {\n      try {\n        var x = {};\n        _window.Object.defineProperty(x, \"y\", {\n          value: \"z\"\n        });\n        return x.y === \"z\";\n      } catch (e) {\n        return false;\n      }\n    }()) {\n      return _window.Object.defineProperty;\n    }\n  }();\n  /**\r\n * Convert an `arguments` object into an Array.\r\n *\r\n * @returns The arguments as an Array\r\n * @private\r\n */\n  var _args = function(argumentsObj) {\n    return _slice.call(argumentsObj, 0);\n  };\n  /**\r\n * Get the index of an item in an Array.\r\n *\r\n * @returns The index of an item in the Array, or `-1` if not found.\r\n * @private\r\n */\n  var _inArray = function(item, array, fromIndex) {\n    if (typeof array.indexOf === \"function\") {\n      return array.indexOf(item, fromIndex);\n    }\n    var i, len = array.length;\n    if (typeof fromIndex === \"undefined\") {\n      fromIndex = 0;\n    } else if (fromIndex < 0) {\n      fromIndex = len + fromIndex;\n    }\n    for (i = fromIndex; i < len; i++) {\n      if (_hasOwn.call(array, i) && array[i] === item) {\n        return i;\n      }\n    }\n    return -1;\n  };\n  /**\r\n * Shallow-copy the owned, enumerable properties of one object over to another, similar to jQuery's `$.extend`.\r\n *\r\n * @returns The target object, augmented\r\n * @private\r\n */\n  var _extend = function() {\n    var i, len, arg, prop, src, copy, args = _args(arguments), target = args[0] || {};\n    for (i = 1, len = args.length; i < len; i++) {\n      if ((arg = args[i]) != null) {\n        for (prop in arg) {\n          if (_hasOwn.call(arg, prop)) {\n            src = target[prop];\n            copy = arg[prop];\n            if (target === copy) {\n              continue;\n            }\n            if (copy !== undefined) {\n              target[prop] = copy;\n            }\n          }\n        }\n      }\n    }\n    return target;\n  };\n  /**\r\n * Return a deep copy of the source object or array.\r\n *\r\n * @returns Object or Array\r\n * @private\r\n */\n  var _deepCopy = function(source) {\n    var copy, i, len, prop;\n    if (typeof source !== \"object\" || source == null) {\n      copy = source;\n    } else if (typeof source.length === \"number\") {\n      copy = [];\n      for (i = 0, len = source.length; i < len; i++) {\n        if (_hasOwn.call(source, i)) {\n          copy[i] = _deepCopy(source[i]);\n        }\n      }\n    } else {\n      copy = {};\n      for (prop in source) {\n        if (_hasOwn.call(source, prop)) {\n          copy[prop] = _deepCopy(source[prop]);\n        }\n      }\n    }\n    return copy;\n  };\n  /**\r\n * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to keep.\r\n * The inverse of `_omit`, mostly. The big difference is that these properties do NOT need to be enumerable to\r\n * be kept.\r\n *\r\n * @returns A new filtered object.\r\n * @private\r\n */\n  var _pick = function(obj, keys) {\n    var newObj = {};\n    for (var i = 0, len = keys.length; i < len; i++) {\n      if (keys[i] in obj) {\n        newObj[keys[i]] = obj[keys[i]];\n      }\n    }\n    return newObj;\n  };\n  /**\r\n * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to omit.\r\n * The inverse of `_pick`.\r\n *\r\n * @returns A new filtered object.\r\n * @private\r\n */\n  var _omit = function(obj, keys) {\n    var newObj = {};\n    for (var prop in obj) {\n      if (_inArray(prop, keys) === -1) {\n        newObj[prop] = obj[prop];\n      }\n    }\n    return newObj;\n  };\n  /**\r\n * Get all of an object's owned, enumerable property names. Does NOT include prototype properties.\r\n *\r\n * @returns An Array of property names.\r\n * @private\r\n */\n  var _objectKeys = function(obj) {\n    if (obj == null) {\n      return [];\n    }\n    if (_keys) {\n      return _keys(obj);\n    }\n    var keys = [];\n    for (var prop in obj) {\n      if (_hasOwn.call(obj, prop)) {\n        keys.push(prop);\n      }\n    }\n    return keys;\n  };\n  /**\r\n * Remove all owned, enumerable properties from an object.\r\n *\r\n * @returns The original object without its owned, enumerable properties.\r\n * @private\r\n */\n  var _deleteOwnProperties = function(obj) {\n    if (obj) {\n      for (var prop in obj) {\n        if (_hasOwn.call(obj, prop)) {\n          delete obj[prop];\n        }\n      }\n    }\n    return obj;\n  };\n  /**\r\n * Mark an existing property as read-only.\r\n * @private\r\n */\n  var _makeReadOnly = function(obj, prop) {\n    if (prop in obj && typeof _defineProperty === \"function\") {\n      _defineProperty(obj, prop, {\n        value: obj[prop],\n        writable: false,\n        configurable: true,\n        enumerable: true\n      });\n    }\n  };\n  /**\r\n * Get the current time in milliseconds since the epoch.\r\n *\r\n * @returns Number\r\n * @private\r\n */\n  var _now = function(Date) {\n    return function() {\n      var time;\n      if (Date.now) {\n        time = Date.now();\n      } else {\n        time = new Date().getTime();\n      }\n      return time;\n    };\n  }(_Date);\n  /**\r\n * Determine if an element is contained within another element.\r\n *\r\n * @returns Boolean\r\n * @private\r\n */\n  var _containedBy = function(el, ancestorEl) {\n    if (el && el.nodeType === 1 && ancestorEl && (ancestorEl.nodeType === 1 || ancestorEl.nodeType === 9)) {\n      do {\n        if (el === ancestorEl) {\n          return true;\n        }\n        el = el.parentNode;\n      } while (el);\n    }\n    return false;\n  };\n  /**\r\n * Keep track of the state of the Flash object.\r\n * @private\r\n */\n  var _flashState = {\n    bridge: null,\n    version: \"0.0.0\",\n    pluginType: \"unknown\",\n    disabled: null,\n    outdated: null,\n    unavailable: null,\n    deactivated: null,\n    overdue: null,\n    ready: null\n  };\n  /**\r\n * The minimum Flash Player version required to use ClipAndFile completely.\r\n * @readonly\r\n * @private\r\n */\n  var _minimumFlashVersion = \"11.0.0\";\n  /**\r\n * Keep track of all event listener registrations.\r\n * @private\r\n */\n  var _handlers = {};\n  /**\r\n * Keep track of the currently activated element.\r\n * @private\r\n */\n  var _currentElement;\n  /**\r\n * Keep track of data for the pending clipboard transaction.\r\n * @private\r\n */\n  var _clipData = {};\n  /**\r\n * Keep track of data for the pending file save transaction.\r\n * @private\r\n */\n  var _fileData = {};\n  /**\r\n * Keep track of data formats for the pending clipboard transaction.\r\n * @private\r\n */\n  var _clipDataFormatMap = null;\n  /**\r\n * The `message` store for events\r\n * @private\r\n */\n  var _eventMessages = {\n    ready: \"Flash communication is established\",\n    error: {\n      \"flash-disabled\": \"Flash is disabled or not installed\",\n      \"flash-outdated\": \"Flash is too outdated to support ClipAndFile\",\n      \"flash-unavailable\": \"Flash is unable to communicate bidirectionally with JavaScript\",\n      \"flash-deactivated\": \"Flash is too outdated for your browser and/or is configured as click-to-activate\",\n      \"flash-overdue\": \"Flash communication was established but NOT within the acceptable time limit\"\n    }\n  };\n  /**\r\n * The presumed location of the \"ClipAndFile.swf\" file, based on the location\r\n * of the executing JavaScript file (e.g. \"ClipAndFile.js\", etc.).\r\n * @private\r\n */\n  var _swfPath = function() {\n    var i, jsDir, tmpJsPath, jsPath, swfPath = \"ClipAndFile.swf\";\n    if (!(_document.currentScript && (jsPath = _document.currentScript.src))) {\n      var scripts = _document.getElementsByTagName(\"script\");\n      if (\"readyState\" in scripts[0]) {\n        for (i = scripts.length; i--; ) {\n          if (scripts[i].readyState === \"interactive\" && (jsPath = scripts[i].src)) {\n            break;\n          }\n        }\n      } else if (_document.readyState === \"loading\") {\n        jsPath = scripts[scripts.length - 1].src;\n      } else {\n        for (i = scripts.length; i--; ) {\n          tmpJsPath = scripts[i].src;\n          if (!tmpJsPath) {\n            jsDir = null;\n            break;\n          }\n          tmpJsPath = tmpJsPath.split(\"#\")[0].split(\"?\")[0];\n          tmpJsPath = tmpJsPath.slice(0, tmpJsPath.lastIndexOf(\"/\") + 1);\n          if (jsDir == null) {\n            jsDir = tmpJsPath;\n          } else if (jsDir !== tmpJsPath) {\n            jsDir = null;\n            break;\n          }\n        }\n        if (jsDir !== null) {\n          jsPath = jsDir;\n        }\n      }\n    }\n    if (jsPath) {\n      jsPath = jsPath.split(\"#\")[0].split(\"?\")[0];\n      swfPath = jsPath.slice(0, jsPath.lastIndexOf(\"/\") + 1) + swfPath;\n    }\n    return swfPath;\n  }();\n  /**\r\n * ClipAndFile configuration defaults for the Core module.\r\n * @private\r\n */\n  var _globalConfig = {\n    swfPath: _swfPath,\n    trustedDomains: window.location.host ? [ window.location.host ] : [],\n    cacheBust: true,\n    forceEnhancedClipboard: false,\n    flashLoadTimeout: 3e4,\n    autoActivate: true,\n    bubbleEvents: true,\n    containerId: \"global-clipandfile-html-bridge\",\n    containerClass: \"global-clipandfile-container\",\n    swfObjectId: \"global-clipandfile-flash-bridge\",\n    hoverClass: \"clipandfile-is-hover\",\n    activeClass: \"clipandfile-is-active\",\n    forceHandCursor: false,\n    title: null,\n    zIndex: 999999999\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.config`.\r\n * @private\r\n */\n  var _config = function(options) {\n    if (typeof options === \"object\" && options !== null) {\n      for (var prop in options) {\n        if (_hasOwn.call(options, prop)) {\n          if (/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(prop)) {\n            _globalConfig[prop] = options[prop];\n          } else if (_flashState.bridge == null) {\n            if (prop === \"containerId\" || prop === \"swfObjectId\") {\n              if (_isValidHtml4Id(options[prop])) {\n                _globalConfig[prop] = options[prop];\n              } else {\n                throw new Error(\"The specified `\" + prop + \"` value is not valid as an HTML4 Element ID\");\n              }\n            } else {\n              _globalConfig[prop] = options[prop];\n            }\n          }\n        }\n      }\n    }\n    if (typeof options === \"string\" && options) {\n      if (_hasOwn.call(_globalConfig, options)) {\n        return _globalConfig[options];\n      }\n      return;\n    }\n    return _deepCopy(_globalConfig);\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.state`.\r\n * @private\r\n */\n  var _state = function() {\n    return {\n      browser: _pick(_navigator, [ \"userAgent\", \"platform\", \"appName\" ]),\n      flash: _omit(_flashState, [ \"bridge\" ]),\n      clipandfile: {\n        version: ClipAndFile.version,\n        config: ClipAndFile.config()\n      }\n    };\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.isFlashUnusable`.\r\n * @private\r\n */\n  var _isFlashUnusable = function() {\n    return !!(_flashState.disabled || _flashState.outdated || _flashState.unavailable || _flashState.deactivated);\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.on`.\r\n * @private\r\n */\n  var _on = function(eventType, listener) {\n    var i, len, events, added = {};\n    if (typeof eventType === \"string\" && eventType) {\n      events = eventType.toLowerCase().split(/\\s+/);\n    } else if (typeof eventType === \"object\" && eventType && typeof listener === \"undefined\") {\n      for (i in eventType) {\n        if (_hasOwn.call(eventType, i) && typeof i === \"string\" && i && typeof eventType[i] === \"function\") {\n          ClipAndFile.on(i, eventType[i]);\n        }\n      }\n    }\n    if (events && events.length) {\n      for (i = 0, len = events.length; i < len; i++) {\n        eventType = events[i].replace(/^on/, \"\");\n        added[eventType] = true;\n        if (!_handlers[eventType]) {\n          _handlers[eventType] = [];\n        }\n        _handlers[eventType].push(listener);\n      }\n      if (added.ready && _flashState.ready) {\n        ClipAndFile.emit({\n          type: \"ready\"\n        });\n      }\n      if (added.error) {\n        var errorTypes = [ \"disabled\", \"outdated\", \"unavailable\", \"deactivated\", \"overdue\" ];\n        for (i = 0, len = errorTypes.length; i < len; i++) {\n          if (_flashState[errorTypes[i]] === true) {\n            ClipAndFile.emit({\n              type: \"error\",\n              name: \"flash-\" + errorTypes[i]\n            });\n            break;\n          }\n        }\n      }\n    }\n    return ClipAndFile;\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.off`.\r\n * @private\r\n */\n  var _off = function(eventType, listener) {\n    var i, len, foundIndex, events, perEventHandlers;\n    if (arguments.length === 0) {\n      events = _objectKeys(_handlers);\n    } else if (typeof eventType === \"string\" && eventType) {\n      events = eventType.split(/\\s+/);\n    } else if (typeof eventType === \"object\" && eventType && typeof listener === \"undefined\") {\n      for (i in eventType) {\n        if (_hasOwn.call(eventType, i) && typeof i === \"string\" && i && typeof eventType[i] === \"function\") {\n          ClipAndFile.off(i, eventType[i]);\n        }\n      }\n    }\n    if (events && events.length) {\n      for (i = 0, len = events.length; i < len; i++) {\n        eventType = events[i].toLowerCase().replace(/^on/, \"\");\n        perEventHandlers = _handlers[eventType];\n        if (perEventHandlers && perEventHandlers.length) {\n          if (listener) {\n            foundIndex = _inArray(listener, perEventHandlers);\n            while (foundIndex !== -1) {\n              perEventHandlers.splice(foundIndex, 1);\n              foundIndex = _inArray(listener, perEventHandlers, foundIndex);\n            }\n          } else {\n            perEventHandlers.length = 0;\n          }\n        }\n      }\n    }\n    return ClipAndFile;\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.handlers`.\r\n * @private\r\n */\n  var _listeners = function(eventType) {\n    var copy;\n    if (typeof eventType === \"string\" && eventType) {\n      copy = _deepCopy(_handlers[eventType]) || null;\n    } else {\n      copy = _deepCopy(_handlers);\n    }\n    return copy;\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.emit`.\r\n * @private\r\n */\n  var _emit = function(event) {\n    var eventCopy, returnVal, tmp;\n    event = _createEvent(event);\n    if (!event) {\n      return;\n    }\n    if (_preprocessEvent(event)) {\n      return;\n    }\n    if (event.type === \"ready\" && _flashState.overdue === true) {\n      return ClipAndFile.emit({\n        type: \"error\",\n        name: \"flash-overdue\"\n      });\n    }\n    eventCopy = _extend({}, event);\n    _dispatchCallbacks.call(this, eventCopy);\n    if (event.type === \"copy\") {\n      tmp = _mapClipDataToFlash(_clipData, _fileData);\n      returnVal = tmp.data;\n      _clipDataFormatMap = tmp.formatMap;\n    }\n    return returnVal;\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.create`.\r\n * @private\r\n */\n  var _create = function() {\n    if (typeof _flashState.ready !== \"boolean\") {\n      _flashState.ready = false;\n    }\n    if (!ClipAndFile.isFlashUnusable() && _flashState.bridge === null) {\n      var maxWait = _globalConfig.flashLoadTimeout;\n      if (typeof maxWait === \"number\" && maxWait >= 0) {\n        _setTimeout(function() {\n          if (typeof _flashState.deactivated !== \"boolean\") {\n            _flashState.deactivated = true;\n          }\n          if (_flashState.deactivated === true) {\n            ClipAndFile.emit({\n              type: \"error\",\n              name: \"flash-deactivated\"\n            });\n          }\n        }, maxWait);\n      }\n      _flashState.overdue = false;\n      _embedSwf();\n    }\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.destroy`.\r\n * @private\r\n */\n  var _destroy = function() {\n    ClipAndFile.clearData();\n    ClipAndFile.deactivate();\n    ClipAndFile.emit(\"destroy\");\n    _unembedSwf();\n    ClipAndFile.off();\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.setData`.\r\n * @private\r\n */\n  var _setData = function(format, data) {\n    var dataObj;\n    if (typeof format === \"object\" && format && typeof data === \"undefined\") {\n      dataObj = format;\n      ClipAndFile.clearData();\n    } else if (typeof format === \"string\" && format) {\n      _deleteOwnProperties(_fileData);\n      dataObj = {};\n      dataObj[format] = data;\n    } else {\n      return;\n    }\n    for (var dataFormat in dataObj) {\n      if (typeof dataFormat === \"string\" && dataFormat && _hasOwn.call(dataObj, dataFormat) && typeof dataObj[dataFormat] === \"string\" && dataObj[dataFormat]) {\n        _clipData[dataFormat] = dataObj[dataFormat];\n      }\n    }\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.setFile`.\r\n * @private\r\n */\n  var _setFile = function(filename, data, b64) {\n    b64 = !!b64;\n    data = data || \"\";\n    if (typeof data === \"string\" && typeof filename === \"string\" && filename) {\n      ClipAndFile.clearData();\n      _fileData.filename = filename;\n      _fileData.file = data;\n      _fileData.b64 = b64;\n    }\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.clearData`.\r\n * @private\r\n */\n  var _clearData = function(format) {\n    if (typeof format === \"undefined\") {\n      _deleteOwnProperties(_clipData);\n      _deleteOwnProperties(_fileData);\n      _clipDataFormatMap = null;\n    } else if (typeof format === \"string\" && _hasOwn.call(_clipData, format)) {\n      delete _clipData[format];\n    }\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.activate`.\r\n * @private\r\n */\n  var _activate = function(element) {\n    if (!(element && element.nodeType === 1)) {\n      return;\n    }\n    if (_currentElement) {\n      _removeClass(_currentElement, _globalConfig.activeClass);\n      if (_currentElement !== element) {\n        _removeClass(_currentElement, _globalConfig.hoverClass);\n      }\n    }\n    _currentElement = element;\n    _addClass(element, _globalConfig.hoverClass);\n    var newTitle = element.getAttribute(\"title\") || _globalConfig.title;\n    if (typeof newTitle === \"string\" && newTitle) {\n      var htmlBridge = _getHtmlBridge(_flashState.bridge);\n      if (htmlBridge) {\n        htmlBridge.setAttribute(\"title\", newTitle);\n      }\n    }\n    var useHandCursor = _globalConfig.forceHandCursor === true || _getStyle(element, \"cursor\") === \"pointer\";\n    _setHandCursor(useHandCursor);\n    _reposition();\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.deactivate`.\r\n * @private\r\n */\n  var _deactivate = function() {\n    var htmlBridge = _getHtmlBridge(_flashState.bridge);\n    if (htmlBridge) {\n      htmlBridge.removeAttribute(\"title\");\n      htmlBridge.style.left = \"0px\";\n      htmlBridge.style.top = \"-9999px\";\n      htmlBridge.style.width = \"1px\";\n      htmlBridge.style.top = \"1px\";\n    }\n    if (_currentElement) {\n      _removeClass(_currentElement, _globalConfig.hoverClass);\n      _removeClass(_currentElement, _globalConfig.activeClass);\n      _currentElement = null;\n    }\n  };\n  /**\r\n * Check if a value is a valid HTML4 `ID` or `Name` token.\r\n * @private\r\n */\n  var _isValidHtml4Id = function(id) {\n    return typeof id === \"string\" && id && /^[A-Za-z][A-Za-z0-9_:\\-\\.]*$/.test(id);\n  };\n  /**\r\n * Create or update an `event` object, based on the `eventType`.\r\n * @private\r\n */\n  var _createEvent = function(event) {\n    var eventType;\n    if (typeof event === \"string\" && event) {\n      eventType = event;\n      event = {};\n    } else if (typeof event === \"object\" && event && typeof event.type === \"string\" && event.type) {\n      eventType = event.type;\n    }\n    if (!eventType) {\n      return;\n    }\n    _extend(event, {\n      type: eventType.toLowerCase(),\n      target: event.target || _currentElement || null,\n      relatedTarget: event.relatedTarget || null,\n      currentTarget: _flashState && _flashState.bridge || null,\n      timeStamp: event.timeStamp || _now() || null\n    });\n    var msg = _eventMessages[event.type];\n    if (event.type === \"error\" && event.name && msg) {\n      msg = msg[event.name];\n    }\n    if (msg) {\n      event.message = msg;\n    }\n    if (event.type === \"ready\") {\n      _extend(event, {\n        target: null,\n        version: _flashState.version\n      });\n    }\n    if (event.type === \"error\") {\n      if (/^flash-(disabled|outdated|unavailable|deactivated|overdue)$/.test(event.name)) {\n        _extend(event, {\n          target: null,\n          minimumVersion: _minimumFlashVersion\n        });\n      }\n      if (/^flash-(outdated|unavailable|deactivated|overdue)$/.test(event.name)) {\n        _extend(event, {\n          version: _flashState.version\n        });\n      }\n    }\n    if (event.type === \"copy\") {\n      event.clipboardData = {\n        setData: ClipAndFile.setData,\n        setFile: ClipAndFile.setFile,\n        clearData: ClipAndFile.clearData\n      };\n    }\n    if (event.type === \"aftercopy\") {\n      event = _mapClipResultsFromFlash(event, _clipDataFormatMap);\n    }\n    if (event.target && !event.relatedTarget) {\n      event.relatedTarget = _getRelatedTarget(event.target);\n    }\n    event = _addMouseData(event);\n    return event;\n  };\n  /**\r\n * Get a relatedTarget from the target's `data-clipboard-target` attribute\r\n * @private\r\n */\n  var _getRelatedTarget = function(targetEl) {\n    var relatedTargetId = targetEl && targetEl.getAttribute && targetEl.getAttribute(\"data-clipboard-target\");\n    return relatedTargetId ? _document.getElementById(relatedTargetId) : null;\n  };\n  /**\r\n * Add element and position data to `MouseEvent` instances\r\n * @private\r\n */\n  var _addMouseData = function(event) {\n    if (event && /^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {\n      var srcElement = event.target;\n      var fromElement = event.type === \"_mouseover\" && event.relatedTarget ? event.relatedTarget : undefined;\n      var toElement = event.type === \"_mouseout\" && event.relatedTarget ? event.relatedTarget : undefined;\n      var pos = _getDOMObjectPosition(srcElement);\n      var screenLeft = _window.screenLeft || _window.screenX || 0;\n      var screenTop = _window.screenTop || _window.screenY || 0;\n      var scrollLeft = _document.body.scrollLeft + _document.documentElement.scrollLeft;\n      var scrollTop = _document.body.scrollTop + _document.documentElement.scrollTop;\n      var pageX = pos.left + (typeof event._stageX === \"number\" ? event._stageX : 0);\n      var pageY = pos.top + (typeof event._stageY === \"number\" ? event._stageY : 0);\n      var clientX = pageX - scrollLeft;\n      var clientY = pageY - scrollTop;\n      var screenX = screenLeft + clientX;\n      var screenY = screenTop + clientY;\n      var moveX = typeof event.movementX === \"number\" ? event.movementX : 0;\n      var moveY = typeof event.movementY === \"number\" ? event.movementY : 0;\n      delete event._stageX;\n      delete event._stageY;\n      _extend(event, {\n        srcElement: srcElement,\n        fromElement: fromElement,\n        toElement: toElement,\n        screenX: screenX,\n        screenY: screenY,\n        pageX: pageX,\n        pageY: pageY,\n        clientX: clientX,\n        clientY: clientY,\n        x: clientX,\n        y: clientY,\n        movementX: moveX,\n        movementY: moveY,\n        offsetX: 0,\n        offsetY: 0,\n        layerX: 0,\n        layerY: 0\n      });\n    }\n    return event;\n  };\n  /**\r\n * Determine if an event's registered handlers should be execute synchronously or asynchronously.\r\n *\r\n * @returns {boolean}\r\n * @private\r\n */\n  var _shouldPerformAsync = function(event) {\n    var eventType = event && typeof event.type === \"string\" && event.type || \"\";\n    return !/^(?:(?:before)?copy|destroy)$/.test(eventType);\n  };\n  /**\r\n * Control if a callback should be executed asynchronously or not.\r\n *\r\n * @returns `undefined`\r\n * @private\r\n */\n  var _dispatchCallback = function(func, context, args, async) {\n    if (async) {\n      _setTimeout(function() {\n        func.apply(context, args);\n      }, 0);\n    } else {\n      func.apply(context, args);\n    }\n  };\n  /**\r\n * Handle the actual dispatching of events to client instances.\r\n *\r\n * @returns `undefined`\r\n * @private\r\n */\n  var _dispatchCallbacks = function(event) {\n    if (!(typeof event === \"object\" && event && event.type)) {\n      return;\n    }\n    var async = _shouldPerformAsync(event);\n    var wildcardTypeHandlers = _handlers[\"*\"] || [];\n    var specificTypeHandlers = _handlers[event.type] || [];\n    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);\n    if (handlers && handlers.length) {\n      var i, len, func, context, eventCopy, originalContext = this;\n      for (i = 0, len = handlers.length; i < len; i++) {\n        func = handlers[i];\n        context = originalContext;\n        if (typeof func === \"string\" && typeof _window[func] === \"function\") {\n          func = _window[func];\n        }\n        if (typeof func === \"object\" && func && typeof func.handleEvent === \"function\") {\n          context = func;\n          func = func.handleEvent;\n        }\n        if (typeof func === \"function\") {\n          eventCopy = _extend({}, event);\n          _dispatchCallback(func, context, [ eventCopy ], async);\n        }\n      }\n    }\n    return this;\n  };\n  var _preprocessCopyEvent = function(event) {\n    var textContent, htmlContent, filename, targetEl = event.relatedTarget;\n    if (event.target && (filename = event.target.getAttribute(\"data-clipboard-file\"))) {\n      if (targetEl && (textContent = targetEl.value || targetEl.textContent || targetEl.innerText)) {\n        event.clipboardData.setFile(filename, textContent);\n      } else if (textContent = event.target.getAttribute(\"data-clipboard-text\")) {\n        event.clipboardData.setFile(filename, textContent);\n      } else if (textContent = event.target.getAttribute(\"data-clipboard-b64\")) {\n        event.clipboardData.setFile(filename, textContent, true);\n      }\n    } else {\n      if (!(_clipData[\"text/html\"] || _clipData[\"text/plain\"]) && targetEl && (htmlContent = targetEl.value || targetEl.outerHTML || targetEl.innerHTML) && (textContent = targetEl.value || targetEl.textContent || targetEl.innerText)) {\n        event.clipboardData.clearData();\n        event.clipboardData.setData(\"text/plain\", textContent);\n        if (htmlContent !== textContent) {\n          event.clipboardData.setData(\"text/html\", htmlContent);\n        }\n      } else if (!_clipData[\"text/plain\"] && event.target && (textContent = event.target.getAttribute(\"data-clipboard-text\"))) {\n        event.clipboardData.clearData();\n        event.clipboardData.setData(\"text/plain\", textContent);\n      }\n    }\n  };\n  /**\r\n * Preprocess any special behaviors, reactions, or state changes after receiving this event.\r\n * Executes only once per event emitted, NOT once per client.\r\n * @private\r\n */\n  var _preprocessEvent = function(event) {\n    var element = event.target || _currentElement || null;\n    var sourceIsSwf = event._source === \"swf\";\n    delete event._source;\n    switch (event.type) {\n     case \"error\":\n      if (_inArray(event.name, [ \"flash-disabled\", \"flash-outdated\", \"flash-deactivated\", \"flash-overdue\" ])) {\n        _extend(_flashState, {\n          disabled: event.name === \"flash-disabled\",\n          outdated: event.name === \"flash-outdated\",\n          unavailable: event.name === \"flash-unavailable\",\n          deactivated: event.name === \"flash-deactivated\",\n          overdue: event.name === \"flash-overdue\",\n          ready: false\n        });\n      }\n      break;\n\n     case \"ready\":\n      var wasDeactivated = _flashState.deactivated === true;\n      _extend(_flashState, {\n        disabled: false,\n        outdated: false,\n        unavailable: false,\n        deactivated: false,\n        overdue: wasDeactivated,\n        ready: !wasDeactivated\n      });\n      break;\n\n     case \"copy\":\n      _preprocessCopyEvent(event);\n      break;\n\n     case \"aftercopy\":\n      ClipAndFile.clearData();\n      if (element && element !== _safeActiveElement() && element.focus) {\n        element.focus();\n      }\n      break;\n\n     case \"_mouseover\":\n      ClipAndFile.activate(element);\n      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {\n        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {\n          _fireMouseEvent(_extend({}, event, {\n            type: \"mouseenter\",\n            bubbles: false,\n            cancelable: false\n          }));\n        }\n        _fireMouseEvent(_extend({}, event, {\n          type: \"mouseover\"\n        }));\n      }\n      break;\n\n     case \"_mouseout\":\n      ClipAndFile.deactivate();\n      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {\n        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {\n          _fireMouseEvent(_extend({}, event, {\n            type: \"mouseleave\",\n            bubbles: false,\n            cancelable: false\n          }));\n        }\n        _fireMouseEvent(_extend({}, event, {\n          type: \"mouseout\"\n        }));\n      }\n      break;\n\n     case \"_mousedown\":\n      _addClass(element, _globalConfig.activeClass);\n      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {\n        _fireMouseEvent(_extend({}, event, {\n          type: event.type.slice(1)\n        }));\n      }\n      break;\n\n     case \"_mouseup\":\n      _removeClass(element, _globalConfig.activeClass);\n      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {\n        _fireMouseEvent(_extend({}, event, {\n          type: event.type.slice(1)\n        }));\n      }\n      break;\n\n     case \"_click\":\n     case \"_mousemove\":\n      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {\n        _fireMouseEvent(_extend({}, event, {\n          type: event.type.slice(1)\n        }));\n      }\n      break;\n    }\n    if (/^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {\n      return true;\n    }\n  };\n  /**\r\n * Dispatch a synthetic MouseEvent.\r\n *\r\n * @returns `undefined`\r\n * @private\r\n */\n  var _fireMouseEvent = function(event) {\n    if (!(event && typeof event.type === \"string\" && event)) {\n      return;\n    }\n    var e, target = event.target || event.srcElement || null, doc = target && target.ownerDocument || _document, defaults = {\n      view: doc.defaultView || _window,\n      canBubble: true,\n      cancelable: true,\n      detail: event.type === \"click\" ? 1 : 0,\n      button: typeof event.which === \"number\" ? event.which - 1 : typeof event.button === \"number\" ? event.button : doc.createEvent ? 0 : 1\n    }, args = _extend(defaults, event);\n    if (!target) {\n      return;\n    }\n    if (doc.createEvent && target.dispatchEvent) {\n      args = [ args.type, args.canBubble, args.cancelable, args.view, args.detail, args.screenX, args.screenY, args.clientX, args.clientY, args.ctrlKey, args.altKey, args.shiftKey, args.metaKey, args.button, args.relatedTarget ];\n      e = doc.createEvent(\"MouseEvents\");\n      if (e.initMouseEvent) {\n        e.initMouseEvent.apply(e, args);\n        target.dispatchEvent(e);\n      }\n    } else if (doc.createEventObject && target.fireEvent) {\n      e = doc.createEventObject(args);\n      target.fireEvent(\"on\" + args.type, e);\n    }\n  };\n  /**\r\n * Create the HTML bridge element to embed the Flash object into.\r\n * @private\r\n */\n  var _createHtmlBridge = function() {\n    var container = _document.createElement(\"div\");\n    container.id = _globalConfig.containerId;\n    container.className = _globalConfig.containerClass;\n    container.style.position = \"absolute\";\n    container.style.left = \"0px\";\n    container.style.top = \"-9999px\";\n    container.style.width = \"1px\";\n    container.style.height = \"1px\";\n    container.style.zIndex = \"\" + _getSafeZIndex(_globalConfig.zIndex);\n    return container;\n  };\n  /**\r\n * Get the HTML element container that wraps the Flash bridge object/element.\r\n * @private\r\n */\n  var _getHtmlBridge = function(flashBridge) {\n    var htmlBridge = flashBridge && flashBridge.parentNode;\n    while (htmlBridge && htmlBridge.nodeName === \"OBJECT\" && htmlBridge.parentNode) {\n      htmlBridge = htmlBridge.parentNode;\n    }\n    return htmlBridge || null;\n  };\n  /**\r\n * Create the SWF object.\r\n *\r\n * @returns The SWF object reference.\r\n * @private\r\n */\n  var _embedSwf = function() {\n    var len, flashBridge = _flashState.bridge, container = _getHtmlBridge(flashBridge);\n    if (!flashBridge) {\n      var allowScriptAccess = _determineScriptAccess(_window.location.host, _globalConfig);\n      var allowNetworking = allowScriptAccess === \"never\" ? \"none\" : \"all\";\n      var flashvars = _vars(_globalConfig);\n      var swfUrl = _globalConfig.swfPath + _cacheBust(_globalConfig.swfPath, _globalConfig);\n      container = _createHtmlBridge();\n      var divToBeReplaced = _document.createElement(\"div\");\n      container.appendChild(divToBeReplaced);\n      _document.body.appendChild(container);\n      var tmpDiv = _document.createElement(\"div\");\n      var oldIE = _flashState.pluginType === \"activex\";\n      tmpDiv.innerHTML = '<object id=\"' + _globalConfig.swfObjectId + '\" name=\"' + _globalConfig.swfObjectId + '\" ' + 'width=\"100%\" height=\"100%\" ' + (oldIE ? 'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"' : 'type=\"application/x-shockwave-flash\" data=\"' + swfUrl + '\"') + \">\" + (oldIE ? '<param name=\"movie\" value=\"' + swfUrl + '\"/>' : \"\") + '<param name=\"allowScriptAccess\" value=\"' + allowScriptAccess + '\"/>' + '<param name=\"allowNetworking\" value=\"' + allowNetworking + '\"/>' + '<param name=\"menu\" value=\"false\"/>' + '<param name=\"wmode\" value=\"transparent\"/>' + '<param name=\"flashvars\" value=\"' + flashvars + '\"/>' + \"</object>\";\n      flashBridge = tmpDiv.firstChild;\n      tmpDiv = null;\n      flashBridge.ClipAndFile = ClipAndFile;\n      container.replaceChild(flashBridge, divToBeReplaced);\n    }\n    if (!flashBridge) {\n      flashBridge = _document[_globalConfig.swfObjectId];\n      if (flashBridge && (len = flashBridge.length)) {\n        flashBridge = flashBridge[len - 1];\n      }\n      if (!flashBridge && container) {\n        flashBridge = container.firstChild;\n      }\n    }\n    _flashState.bridge = flashBridge || null;\n    return flashBridge;\n  };\n  /**\r\n * Destroy the SWF object.\r\n * @private\r\n */\n  var _unembedSwf = function() {\n    var flashBridge = _flashState.bridge;\n    if (flashBridge) {\n      var htmlBridge = _getHtmlBridge(flashBridge);\n      if (htmlBridge) {\n        if (_flashState.pluginType === \"activex\" && \"readyState\" in flashBridge) {\n          flashBridge.style.display = \"none\";\n          (function removeSwfFromIE() {\n            if (flashBridge.readyState === 4) {\n              for (var prop in flashBridge) {\n                if (typeof flashBridge[prop] === \"function\") {\n                  flashBridge[prop] = null;\n                }\n              }\n              if (flashBridge.parentNode) {\n                flashBridge.parentNode.removeChild(flashBridge);\n              }\n              if (htmlBridge.parentNode) {\n                htmlBridge.parentNode.removeChild(htmlBridge);\n              }\n            } else {\n              _setTimeout(removeSwfFromIE, 10);\n            }\n          })();\n        } else {\n          if (flashBridge.parentNode) {\n            flashBridge.parentNode.removeChild(flashBridge);\n          }\n          if (htmlBridge.parentNode) {\n            htmlBridge.parentNode.removeChild(htmlBridge);\n          }\n        }\n      }\n      _flashState.ready = null;\n      _flashState.bridge = null;\n      _flashState.deactivated = null;\n    }\n  };\n  /**\r\n * Map the data format names of the \"clipData\" to Flash-friendly names.\r\n *\r\n * @returns A new transformed object.\r\n * @private\r\n */\n  var _mapClipDataToFlash = function(clipData, fileData) {\n    var newClipData = {}, formatMap = {};\n    if (!(typeof clipData === \"object\" && clipData)) {\n      return;\n    }\n    if (typeof fileData === \"object\" && fileData && fileData.filename) {\n      newClipData.file = fileData.file;\n      newClipData.filename = fileData.filename;\n      newClipData.b64 = fileData.b64;\n      formatMap.file = \"file\";\n    } else {\n      for (var dataFormat in clipData) {\n        if (dataFormat && _hasOwn.call(clipData, dataFormat) && typeof clipData[dataFormat] === \"string\" && clipData[dataFormat]) {\n          switch (dataFormat.toLowerCase()) {\n           case \"text/plain\":\n           case \"text\":\n           case \"air:text\":\n           case \"flash:text\":\n            newClipData.text = clipData[dataFormat];\n            formatMap.text = dataFormat;\n            break;\n\n           case \"text/html\":\n           case \"html\":\n           case \"air:html\":\n           case \"flash:html\":\n            newClipData.html = clipData[dataFormat];\n            formatMap.html = dataFormat;\n            break;\n\n           case \"application/rtf\":\n           case \"text/rtf\":\n           case \"rtf\":\n           case \"richtext\":\n           case \"air:rtf\":\n           case \"flash:rtf\":\n            newClipData.rtf = clipData[dataFormat];\n            formatMap.rtf = dataFormat;\n            break;\n\n           default:\n            break;\n          }\n        }\n      }\n    }\n    return {\n      data: newClipData,\n      formatMap: formatMap\n    };\n  };\n  /**\r\n * Map the data format names from Flash-friendly names back to their original \"clipData\" names (via a format mapping).\r\n *\r\n * @returns A new transformed object.\r\n * @private\r\n */\n  var _mapClipResultsFromFlash = function(clipResults, formatMap) {\n    if (!(typeof clipResults === \"object\" && clipResults && typeof formatMap === \"object\" && formatMap)) {\n      return clipResults;\n    }\n    var newResults = {};\n    for (var prop in clipResults) {\n      if (_hasOwn.call(clipResults, prop)) {\n        if (prop !== \"success\" && prop !== \"data\") {\n          newResults[prop] = clipResults[prop];\n          continue;\n        }\n        newResults[prop] = {};\n        var tmpHash = clipResults[prop];\n        for (var dataFormat in tmpHash) {\n          if (dataFormat && _hasOwn.call(tmpHash, dataFormat) && _hasOwn.call(formatMap, dataFormat)) {\n            newResults[prop][formatMap[dataFormat]] = tmpHash[dataFormat];\n          }\n        }\n      }\n    }\n    return newResults;\n  };\n  /**\r\n * Will look at a path, and will create a \"?noCache={time}\" or \"&noCache={time}\"\r\n * query param string to return. Does NOT append that string to the original path.\r\n * This is useful because ExternalInterface often breaks when a Flash SWF is cached.\r\n *\r\n * @returns The `noCache` query param with necessary \"?\"/\"&\" prefix.\r\n * @private\r\n */\n  var _cacheBust = function(path, options) {\n    var cacheBust = options == null || options && options.cacheBust === true;\n    if (cacheBust) {\n      return (path.indexOf(\"?\") === -1 ? \"?\" : \"&\") + \"noCache=\" + _now();\n    } else {\n      return \"\";\n    }\n  };\n  /**\r\n * Creates a query string for the FlashVars param.\r\n * Does NOT include the cache-busting query param.\r\n *\r\n * @returns FlashVars query string\r\n * @private\r\n */\n  var _vars = function(options) {\n    var i, len, domain, domains, str = \"\", trustedOriginsExpanded = [];\n    if (options.trustedDomains) {\n      if (typeof options.trustedDomains === \"string\") {\n        domains = [ options.trustedDomains ];\n      } else if (typeof options.trustedDomains === \"object\" && \"length\" in options.trustedDomains) {\n        domains = options.trustedDomains;\n      }\n    }\n    if (domains && domains.length) {\n      for (i = 0, len = domains.length; i < len; i++) {\n        if (_hasOwn.call(domains, i) && domains[i] && typeof domains[i] === \"string\") {\n          domain = _extractDomain(domains[i]);\n          if (!domain) {\n            continue;\n          }\n          if (domain === \"*\") {\n            trustedOriginsExpanded = [ domain ];\n            break;\n          }\n          trustedOriginsExpanded.push.apply(trustedOriginsExpanded, [ domain, \"//\" + domain, _window.location.protocol + \"//\" + domain ]);\n        }\n      }\n    }\n    if (trustedOriginsExpanded.length) {\n      str += \"trustedOrigins=\" + _encodeURIComponent(trustedOriginsExpanded.join(\",\"));\n    }\n    if (options.forceEnhancedClipboard === true) {\n      str += (str ? \"&\" : \"\") + \"forceEnhancedClipboard=true\";\n    }\n    if (typeof options.swfObjectId === \"string\" && options.swfObjectId) {\n      str += (str ? \"&\" : \"\") + \"swfObjectId=\" + _encodeURIComponent(options.swfObjectId);\n    }\n    return str;\n  };\n  /**\r\n * Extract the domain (e.g. \"github.com\") from an origin (e.g. \"https://github.com\") or\r\n * URL (e.g. \"https://github.com/zeroclipboard/zeroclipboard/\").\r\n *\r\n * @returns the domain\r\n * @private\r\n */\n  var _extractDomain = function(originOrUrl) {\n    if (originOrUrl == null || originOrUrl === \"\") {\n      return null;\n    }\n    originOrUrl = originOrUrl.replace(/^\\s+|\\s+$/g, \"\");\n    if (originOrUrl === \"\") {\n      return null;\n    }\n    var protocolIndex = originOrUrl.indexOf(\"//\");\n    originOrUrl = protocolIndex === -1 ? originOrUrl : originOrUrl.slice(protocolIndex + 2);\n    var pathIndex = originOrUrl.indexOf(\"/\");\n    originOrUrl = pathIndex === -1 ? originOrUrl : protocolIndex === -1 || pathIndex === 0 ? null : originOrUrl.slice(0, pathIndex);\n    if (originOrUrl && originOrUrl.slice(-4).toLowerCase() === \".swf\") {\n      return null;\n    }\n    return originOrUrl || null;\n  };\n  /**\r\n * Set `allowScriptAccess` based on `trustedDomains` and `window.location.host` vs. `swfPath`.\r\n *\r\n * @returns The appropriate script access level.\r\n * @private\r\n */\n  var _determineScriptAccess = function() {\n    var _extractAllDomains = function(origins, resultsArray) {\n      var i, len, tmp;\n      if (origins == null || resultsArray[0] === \"*\") {\n        return;\n      }\n      if (typeof origins === \"string\") {\n        origins = [ origins ];\n      }\n      if (!(typeof origins === \"object\" && typeof origins.length === \"number\")) {\n        return;\n      }\n      for (i = 0, len = origins.length; i < len; i++) {\n        if (_hasOwn.call(origins, i) && (tmp = _extractDomain(origins[i]))) {\n          if (tmp === \"*\") {\n            resultsArray.length = 0;\n            resultsArray.push(\"*\");\n            break;\n          }\n          if (_inArray(tmp, resultsArray) === -1) {\n            resultsArray.push(tmp);\n          }\n        }\n      }\n    };\n    return function(currentDomain, configOptions) {\n      var swfDomain = _extractDomain(configOptions.swfPath);\n      if (swfDomain === null) {\n        swfDomain = currentDomain;\n      }\n      var trustedDomains = [];\n      _extractAllDomains(configOptions.trustedOrigins, trustedDomains);\n      _extractAllDomains(configOptions.trustedDomains, trustedDomains);\n      var len = trustedDomains.length;\n      if (len > 0) {\n        if (len === 1 && trustedDomains[0] === \"*\") {\n          return \"always\";\n        }\n        if (_inArray(currentDomain, trustedDomains) !== -1) {\n          if (len === 1 && currentDomain === swfDomain) {\n            return \"sameDomain\";\n          }\n          return \"always\";\n        }\n      }\n      return \"never\";\n    };\n  }();\n  /**\r\n * Get the currently active/focused DOM element.\r\n *\r\n * @returns the currently active/focused element, or `null`\r\n * @private\r\n */\n  var _safeActiveElement = function() {\n    try {\n      return _document.activeElement;\n    } catch (err) {\n      return null;\n    }\n  };\n  /**\r\n * Add a class to an element, if it doesn't already have it.\r\n *\r\n * @returns The element, with its new class added.\r\n * @private\r\n */\n  var _addClass = function(element, value) {\n    if (!element || element.nodeType !== 1) {\n      return element;\n    }\n    if (element.classList) {\n      if (!element.classList.contains(value)) {\n        element.classList.add(value);\n      }\n      return element;\n    }\n    if (value && typeof value === \"string\") {\n      var classNames = (value || \"\").split(/\\s+/);\n      if (element.nodeType === 1) {\n        if (!element.className) {\n          element.className = value;\n        } else {\n          var className = \" \" + element.className + \" \", setClass = element.className;\n          for (var c = 0, cl = classNames.length; c < cl; c++) {\n            if (className.indexOf(\" \" + classNames[c] + \" \") < 0) {\n              setClass += \" \" + classNames[c];\n            }\n          }\n          element.className = setClass.replace(/^\\s+|\\s+$/g, \"\");\n        }\n      }\n    }\n    return element;\n  };\n  /**\r\n * Remove a class from an element, if it has it.\r\n *\r\n * @returns The element, with its class removed.\r\n * @private\r\n */\n  var _removeClass = function(element, value) {\n    if (!element || element.nodeType !== 1) {\n      return element;\n    }\n    if (element.classList) {\n      if (element.classList.contains(value)) {\n        element.classList.remove(value);\n      }\n      return element;\n    }\n    if (typeof value === \"string\" && value) {\n      var classNames = value.split(/\\s+/);\n      if (element.nodeType === 1 && element.className) {\n        var className = (\" \" + element.className + \" \").replace(/[\\n\\t]/g, \" \");\n        for (var c = 0, cl = classNames.length; c < cl; c++) {\n          className = className.replace(\" \" + classNames[c] + \" \", \" \");\n        }\n        element.className = className.replace(/^\\s+|\\s+$/g, \"\");\n      }\n    }\n    return element;\n  };\n  /**\r\n * Convert standard CSS property names into the equivalent CSS property names\r\n * for use by oldIE and/or `el.style.{prop}`.\r\n *\r\n * NOTE: oldIE has other special cases that are not accounted for here,\r\n * e.g. \"float\" -> \"styleFloat\"\r\n *\r\n * @example _camelizeCssPropName(\"z-index\") -> \"zIndex\"\r\n *\r\n * @returns The CSS property name for oldIE and/or `el.style.{prop}`\r\n * @private\r\n */\n  var _camelizeCssPropName = function() {\n    var matcherRegex = /\\-([a-z])/g, replacerFn = function(match, group) {\n      return group.toUpperCase();\n    };\n    return function(prop) {\n      return prop.replace(matcherRegex, replacerFn);\n    };\n  }();\n  /**\r\n * Attempt to interpret the element's CSS styling. If `prop` is `\"cursor\"`,\r\n * then we assume that it should be a hand (\"pointer\") cursor if the element\r\n * is an anchor element (\"a\" tag).\r\n *\r\n * @returns The computed style property.\r\n * @private\r\n */\n  var _getStyle = function(el, prop) {\n    var value, camelProp, tagName;\n    if (_window.getComputedStyle) {\n      value = _window.getComputedStyle(el, null).getPropertyValue(prop);\n    } else {\n      camelProp = _camelizeCssPropName(prop);\n      if (el.currentStyle) {\n        value = el.currentStyle[camelProp];\n      } else {\n        value = el.style[camelProp];\n      }\n    }\n    if (prop === \"cursor\") {\n      if (!value || value === \"auto\") {\n        tagName = el.tagName.toLowerCase();\n        if (tagName === \"a\") {\n          return \"pointer\";\n        }\n      }\n    }\n    return value;\n  };\n  /**\r\n * Get the zoom factor of the browser. Always returns `1.0`, except at\r\n * non-default zoom levels in IE<8 and some older versions of WebKit.\r\n *\r\n * @returns Floating unit percentage of the zoom factor (e.g. 150% = `1.5`).\r\n * @private\r\n */\n  var _getZoomFactor = function() {\n    var rect, physicalWidth, logicalWidth, zoomFactor = 1;\n    if (typeof _document.body.getBoundingClientRect === \"function\") {\n      rect = _document.body.getBoundingClientRect();\n      physicalWidth = rect.right - rect.left;\n      logicalWidth = _document.body.offsetWidth;\n      zoomFactor = _Math.round(physicalWidth / logicalWidth * 100) / 100;\n    }\n    return zoomFactor;\n  };\n  /**\r\n * Get the DOM positioning info of an element.\r\n *\r\n * @returns Object containing the element's position, width, and height.\r\n * @private\r\n */\n  var _getDOMObjectPosition = function(obj) {\n    var info = {\n      left: 0,\n      top: 0,\n      width: 0,\n      height: 0\n    };\n    if (obj.getBoundingClientRect) {\n      var rect = obj.getBoundingClientRect();\n      var pageXOffset, pageYOffset, zoomFactor;\n      if (\"pageXOffset\" in _window && \"pageYOffset\" in _window) {\n        pageXOffset = _window.pageXOffset;\n        pageYOffset = _window.pageYOffset;\n      } else {\n        zoomFactor = _getZoomFactor();\n        pageXOffset = _Math.round((_document.body.scrollLeft + _document.documentElement.scrollLeft) / zoomFactor);\n        pageYOffset = _Math.round((_document.body.scrollTop + _document.documentElement.scrollTop) / zoomFactor);\n      }\n      var leftBorderWidth = _document.documentElement.clientLeft || 0;\n      var topBorderWidth = _document.documentElement.clientTop || 0;\n      info.left = rect.left + pageXOffset - leftBorderWidth;\n      info.top = rect.top + pageYOffset - topBorderWidth;\n      info.width = \"width\" in rect ? rect.width : rect.right - rect.left;\n      info.height = \"height\" in rect ? rect.height : rect.bottom - rect.top;\n    }\n    return info;\n  };\n  /**\r\n * Reposition the Flash object to cover the currently activated element.\r\n *\r\n * @returns `undefined`\r\n * @private\r\n */\n  var _reposition = function() {\n    var htmlBridge;\n    if (_currentElement && (htmlBridge = _getHtmlBridge(_flashState.bridge))) {\n      var pos = _getDOMObjectPosition(_currentElement);\n      _extend(htmlBridge.style, {\n        width: pos.width + \"px\",\n        height: pos.height + \"px\",\n        top: pos.top + \"px\",\n        left: pos.left + \"px\",\n        zIndex: \"\" + _getSafeZIndex(_globalConfig.zIndex)\n      });\n    }\n  };\n  /**\r\n * Sends a signal to the Flash object to display the hand cursor if `true`.\r\n *\r\n * @returns `undefined`\r\n * @private\r\n */\n  var _setHandCursor = function(enabled) {\n    if (_flashState.ready === true) {\n      if (_flashState.bridge && typeof _flashState.bridge.setHandCursor === \"function\") {\n        _flashState.bridge.setHandCursor(enabled);\n      } else {\n        _flashState.ready = false;\n      }\n    }\n  };\n  /**\r\n * Get a safe value for `zIndex`\r\n *\r\n * @returns an integer, or \"auto\"\r\n * @private\r\n */\n  var _getSafeZIndex = function(val) {\n    if (/^(?:auto|inherit)$/.test(val)) {\n      return val;\n    }\n    var zIndex;\n    if (typeof val === \"number\" && !_isNaN(val)) {\n      zIndex = val;\n    } else if (typeof val === \"string\") {\n      zIndex = _getSafeZIndex(_parseInt(val, 10));\n    }\n    return typeof zIndex === \"number\" ? zIndex : \"auto\";\n  };\n  /**\r\n * Detect the Flash Player status, version, and plugin type.\r\n *\r\n * @see {@link https://code.google.com/p/doctype-mirror/wiki/ArticleDetectFlash#The_code}\r\n * @see {@link http://stackoverflow.com/questions/12866060/detecting-pepper-ppapi-flash-with-javascript}\r\n *\r\n * @returns `undefined`\r\n * @private\r\n */\n  var _detectFlashSupport = function(ActiveXObject) {\n    var plugin, ax, mimeType, hasFlash = false, isActiveX = false, isPPAPI = false, flashVersion = \"\";\n    /**\r\n   * Derived from Apple's suggested sniffer.\r\n   * @param {String} desc e.g. \"Shockwave Flash 7.0 r61\"\r\n   * @returns {String} \"7.0.61\"\r\n   * @private\r\n   */\n    function parseFlashVersion(desc) {\n      var matches = desc.match(/[\\d]+/g);\n      matches.length = 3;\n      return matches.join(\".\");\n    }\n    function isPepperFlash(flashPlayerFileName) {\n      return !!flashPlayerFileName && (flashPlayerFileName = flashPlayerFileName.toLowerCase()) && (/^(pepflashplayer\\.dll|libpepflashplayer\\.so|pepperflashplayer\\.plugin)$/.test(flashPlayerFileName) || flashPlayerFileName.slice(-13) === \"chrome.plugin\");\n    }\n    function inspectPlugin(plugin) {\n      if (plugin) {\n        hasFlash = true;\n        if (plugin.version) {\n          flashVersion = parseFlashVersion(plugin.version);\n        }\n        if (!flashVersion && plugin.description) {\n          flashVersion = parseFlashVersion(plugin.description);\n        }\n        if (plugin.filename) {\n          isPPAPI = isPepperFlash(plugin.filename);\n        }\n      }\n    }\n    if (_navigator.plugins && _navigator.plugins.length) {\n      plugin = _navigator.plugins[\"Shockwave Flash\"];\n      inspectPlugin(plugin);\n      if (_navigator.plugins[\"Shockwave Flash 2.0\"]) {\n        hasFlash = true;\n        flashVersion = \"2.0.0.11\";\n      }\n    } else if (_navigator.mimeTypes && _navigator.mimeTypes.length) {\n      mimeType = _navigator.mimeTypes[\"application/x-shockwave-flash\"];\n      plugin = mimeType && mimeType.enabledPlugin;\n      inspectPlugin(plugin);\n    } else if (typeof ActiveXObject !== \"undefined\") {\n      isActiveX = true;\n      try {\n        ax = new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.7\");\n        hasFlash = true;\n        flashVersion = parseFlashVersion(ax.GetVariable(\"$version\"));\n      } catch (e1) {\n        try {\n          ax = new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.6\");\n          hasFlash = true;\n          flashVersion = \"6.0.21\";\n        } catch (e2) {\n          try {\n            ax = new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\");\n            hasFlash = true;\n            flashVersion = parseFlashVersion(ax.GetVariable(\"$version\"));\n          } catch (e3) {\n            isActiveX = false;\n          }\n        }\n      }\n    }\n    _flashState.disabled = hasFlash !== true;\n    _flashState.outdated = flashVersion && _parseFloat(flashVersion) < _parseFloat(_minimumFlashVersion);\n    _flashState.version = flashVersion || \"0.0.0\";\n    _flashState.pluginType = isPPAPI ? \"pepper\" : isActiveX ? \"activex\" : hasFlash ? \"netscape\" : \"unknown\";\n  };\n  /**\r\n * Invoke the Flash detection algorithms immediately upon inclusion so we're not waiting later.\r\n */\n  _detectFlashSupport(_ActiveXObject);\n  /**\r\n * A shell constructor for `ClipAndFile` client instances.\r\n *\r\n * @constructor\r\n */\n  var ClipAndFile = function() {\n    if (!(this instanceof ClipAndFile)) {\n      return new ClipAndFile();\n    }\n    if (typeof ClipAndFile._createClient === \"function\") {\n      ClipAndFile._createClient.apply(this, _args(arguments));\n    }\n  };\n  /**\r\n * The ClipAndFile library's version number.\r\n *\r\n * @static\r\n * @readonly\r\n * @property {string}\r\n */\n  ClipAndFile.version = \"0.1.0\";\n  _makeReadOnly(ClipAndFile, \"version\");\n  /**\r\n * Update or get a copy of the ClipAndFile global configuration.\r\n * Returns a copy of the current/updated configuration.\r\n *\r\n * @returns Object\r\n * @static\r\n */\n  ClipAndFile.config = function() {\n    return _config.apply(this, _args(arguments));\n  };\n  /**\r\n * Diagnostic method that describes the state of the browser, Flash Player, and ClipAndFile.\r\n *\r\n * @returns Object\r\n * @static\r\n */\n  ClipAndFile.state = function() {\n    return _state.apply(this, _args(arguments));\n  };\n  /**\r\n * Check if Flash is unusable for any reason: disabled, outdated, deactivated, etc.\r\n *\r\n * @returns Boolean\r\n * @static\r\n */\n  ClipAndFile.isFlashUnusable = function() {\n    return _isFlashUnusable.apply(this, _args(arguments));\n  };\n  /**\r\n * Register an event listener.\r\n *\r\n * @returns `ClipAndFile`\r\n * @static\r\n */\n  ClipAndFile.on = function() {\n    return _on.apply(this, _args(arguments));\n  };\n  /**\r\n * Unregister an event listener.\r\n * If no `listener` function/object is provided, it will unregister all listeners for the provided `eventType`.\r\n * If no `eventType` is provided, it will unregister all listeners for every event type.\r\n *\r\n * @returns `ClipAndFile`\r\n * @static\r\n */\n  ClipAndFile.off = function() {\n    return _off.apply(this, _args(arguments));\n  };\n  /**\r\n * Retrieve event listeners for an `eventType`.\r\n * If no `eventType` is provided, it will retrieve all listeners for every event type.\r\n *\r\n * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`\r\n */\n  ClipAndFile.handlers = function() {\n    return _listeners.apply(this, _args(arguments));\n  };\n  /**\r\n * Event emission receiver from the Flash object, forwarding to any registered JavaScript event listeners.\r\n *\r\n * @returns For the \"copy\" event, returns the Flash-friendly \"clipData\" object; otherwise `undefined`.\r\n * @static\r\n */\n  ClipAndFile.emit = function() {\n    return _emit.apply(this, _args(arguments));\n  };\n  /**\r\n * Create and embed the Flash object.\r\n *\r\n * @returns The Flash object\r\n * @static\r\n */\n  ClipAndFile.create = function() {\n    return _create.apply(this, _args(arguments));\n  };\n  /**\r\n * Self-destruct and clean up everything, including the embedded Flash object.\r\n *\r\n * @returns `undefined`\r\n * @static\r\n */\n  ClipAndFile.destroy = function() {\n    return _destroy.apply(this, _args(arguments));\n  };\n  /**\r\n * Set the pending data for clipboard injection.\r\n *\r\n * @returns `undefined`\r\n * @static\r\n */\n  ClipAndFile.setData = function() {\n    return _setData.apply(this, _args(arguments));\n  };\n  /**\r\n * Stores the pending data to save as a file.  Call only once.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.setFile = function() {\n    return _setFile.apply(this, _args(arguments));\n  };\n  /**\r\n * Clear the pending data for clipboard injection.\r\n * If no `format` is provided, all pending data formats will be cleared.\r\n *\r\n * @returns `undefined`\r\n * @static\r\n */\n  ClipAndFile.clearData = function() {\n    return _clearData.apply(this, _args(arguments));\n  };\n  /**\r\n * Sets the current HTML object that the Flash object should overlay. This will put the global\r\n * Flash object on top of the current element; depending on the setup, this may also set the\r\n * pending clipboard text data as well as the Flash object's wrapping element's title attribute\r\n * based on the underlying HTML element and ClipAndFile configuration.\r\n *\r\n * @returns `undefined`\r\n * @static\r\n */\n  ClipAndFile.activate = function() {\n    return _activate.apply(this, _args(arguments));\n  };\n  /**\r\n * Un-overlays the Flash object. This will put the global Flash object off-screen; depending on\r\n * the setup, this may also unset the Flash object's wrapping element's title attribute based on\r\n * the underlying HTML element and ClipAndFile configuration.\r\n *\r\n * @returns `undefined`\r\n * @static\r\n */\n  ClipAndFile.deactivate = function() {\n    return _deactivate.apply(this, _args(arguments));\n  };\n  /**\r\n * Keep track of the ClipAndFile client instance counter.\r\n */\n  var _clientIdCounter = 0;\n  /**\r\n * Keep track of the state of the client instances.\r\n *\r\n * Entry structure:\r\n *   _clientMeta[client.id] = {\r\n *     instance: client,\r\n *     elements: [],\r\n *     handlers: {}\r\n *   };\r\n */\n  var _clientMeta = {};\n  /**\r\n * Keep track of the ClipAndFile clipped elements counter.\r\n */\n  var _elementIdCounter = 0;\n  /**\r\n * Keep track of the state of the clipped element relationships to clients.\r\n *\r\n * Entry structure:\r\n *   _elementMeta[element.cafClippingId] = [client1.id, client2.id];\r\n */\n  var _elementMeta = {};\n  /**\r\n * Keep track of the state of the mouse event handlers for clipped elements.\r\n *\r\n * Entry structure:\r\n *   _mouseHandlers[element.cafClippingId] = {\r\n *     mouseover: function(event) {},\r\n *     mouseout:  function(event) {},\r\n *     mousedown: function(event) {},\r\n *     mouseup:   function(event) {}\r\n *   };\r\n */\n  var _mouseHandlers = {};\n  /**\r\n * Extending the ClipAndFile configuration defaults for the Client module.\r\n */\n  _extend(_globalConfig, {\n    autoActivate: true\n  });\n  /**\r\n * The real constructor for `ClipAndFile` client instances.\r\n * @private\r\n */\n  var _clientConstructor = function(elements) {\n    var client = this;\n    client.id = \"\" + _clientIdCounter++;\n    _clientMeta[client.id] = {\n      instance: client,\n      elements: [],\n      handlers: {}\n    };\n    if (elements) {\n      client.clip(elements);\n    }\n    ClipAndFile.on(\"*\", function(event) {\n      return client.emit(event);\n    });\n    ClipAndFile.on(\"destroy\", function() {\n      client.destroy();\n    });\n    ClipAndFile.create();\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.Client.prototype.on`.\r\n * @private\r\n */\n  var _clientOn = function(eventType, listener) {\n    var i, len, events, added = {}, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;\n    if (typeof eventType === \"string\" && eventType) {\n      events = eventType.toLowerCase().split(/\\s+/);\n    } else if (typeof eventType === \"object\" && eventType && typeof listener === \"undefined\") {\n      for (i in eventType) {\n        if (_hasOwn.call(eventType, i) && typeof i === \"string\" && i && typeof eventType[i] === \"function\") {\n          this.on(i, eventType[i]);\n        }\n      }\n    }\n    if (events && events.length) {\n      for (i = 0, len = events.length; i < len; i++) {\n        eventType = events[i].replace(/^on/, \"\");\n        added[eventType] = true;\n        if (!handlers[eventType]) {\n          handlers[eventType] = [];\n        }\n        handlers[eventType].push(listener);\n      }\n      if (added.ready && _flashState.ready) {\n        this.emit({\n          type: \"ready\",\n          client: this\n        });\n      }\n      if (added.error) {\n        var errorTypes = [ \"disabled\", \"outdated\", \"unavailable\", \"deactivated\", \"overdue\" ];\n        for (i = 0, len = errorTypes.length; i < len; i++) {\n          if (_flashState[errorTypes[i]]) {\n            this.emit({\n              type: \"error\",\n              name: \"flash-\" + errorTypes[i],\n              client: this\n            });\n            break;\n          }\n        }\n      }\n    }\n    return this;\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.Client.prototype.off`.\r\n * @private\r\n */\n  var _clientOff = function(eventType, listener) {\n    var i, len, foundIndex, events, perEventHandlers, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;\n    if (arguments.length === 0) {\n      events = _objectKeys(handlers);\n    } else if (typeof eventType === \"string\" && eventType) {\n      events = eventType.split(/\\s+/);\n    } else if (typeof eventType === \"object\" && eventType && typeof listener === \"undefined\") {\n      for (i in eventType) {\n        if (_hasOwn.call(eventType, i) && typeof i === \"string\" && i && typeof eventType[i] === \"function\") {\n          this.off(i, eventType[i]);\n        }\n      }\n    }\n    if (events && events.length) {\n      for (i = 0, len = events.length; i < len; i++) {\n        eventType = events[i].toLowerCase().replace(/^on/, \"\");\n        perEventHandlers = handlers[eventType];\n        if (perEventHandlers && perEventHandlers.length) {\n          if (listener) {\n            foundIndex = _inArray(listener, perEventHandlers);\n            while (foundIndex !== -1) {\n              perEventHandlers.splice(foundIndex, 1);\n              foundIndex = _inArray(listener, perEventHandlers, foundIndex);\n            }\n          } else {\n            perEventHandlers.length = 0;\n          }\n        }\n      }\n    }\n    return this;\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.Client.prototype.handlers`.\r\n * @private\r\n */\n  var _clientListeners = function(eventType) {\n    var copy = null, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;\n    if (handlers) {\n      if (typeof eventType === \"string\" && eventType) {\n        copy = handlers[eventType] ? handlers[eventType].slice(0) : [];\n      } else {\n        copy = _deepCopy(handlers);\n      }\n    }\n    return copy;\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.Client.prototype.emit`.\r\n * @private\r\n */\n  var _clientEmit = function(event) {\n    if (_clientShouldEmit.call(this, event)) {\n      if (typeof event === \"object\" && event && typeof event.type === \"string\" && event.type) {\n        event = _extend({}, event);\n      }\n      var eventCopy = _extend({}, _createEvent(event), {\n        client: this\n      });\n      _clientDispatchCallbacks.call(this, eventCopy);\n    }\n    return this;\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.Client.prototype.clip`.\r\n * @private\r\n */\n  var _clientClip = function(elements) {\n    elements = _prepClip(elements);\n    for (var i = 0; i < elements.length; i++) {\n      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {\n        if (!elements[i].cafClippingId) {\n          elements[i].cafClippingId = \"cafClippingId_\" + _elementIdCounter++;\n          _elementMeta[elements[i].cafClippingId] = [ this.id ];\n          if (_globalConfig.autoActivate === true) {\n            _addMouseHandlers(elements[i]);\n          }\n        } else if (_inArray(this.id, _elementMeta[elements[i].cafClippingId]) === -1) {\n          _elementMeta[elements[i].cafClippingId].push(this.id);\n        }\n        var clippedElements = _clientMeta[this.id] && _clientMeta[this.id].elements;\n        if (_inArray(elements[i], clippedElements) === -1) {\n          clippedElements.push(elements[i]);\n        }\n      }\n    }\n    return this;\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.Client.prototype.unclip`.\r\n * @private\r\n */\n  var _clientUnclip = function(elements) {\n    var meta = _clientMeta[this.id];\n    if (!meta) {\n      return this;\n    }\n    var clippedElements = meta.elements;\n    var arrayIndex;\n    if (typeof elements === \"undefined\") {\n      elements = clippedElements.slice(0);\n    } else {\n      elements = _prepClip(elements);\n    }\n    for (var i = elements.length; i--; ) {\n      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {\n        arrayIndex = 0;\n        while ((arrayIndex = _inArray(elements[i], clippedElements, arrayIndex)) !== -1) {\n          clippedElements.splice(arrayIndex, 1);\n        }\n        var clientIds = _elementMeta[elements[i].cafClippingId];\n        if (clientIds) {\n          arrayIndex = 0;\n          while ((arrayIndex = _inArray(this.id, clientIds, arrayIndex)) !== -1) {\n            clientIds.splice(arrayIndex, 1);\n          }\n          if (clientIds.length === 0) {\n            if (_globalConfig.autoActivate === true) {\n              _removeMouseHandlers(elements[i]);\n            }\n            try {\n              delete elements[i].cafClippingId;\n            } catch (e) {\n              elements[i].cafClippingId = undefined;\n            }\n          }\n        }\n      }\n    }\n    return this;\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.Client.prototype.elements`.\r\n * @private\r\n */\n  var _clientElements = function() {\n    var meta = _clientMeta[this.id];\n    return meta && meta.elements ? meta.elements.slice(0) : [];\n  };\n  /**\r\n * The underlying implementation of `ClipAndFile.Client.prototype.destroy`.\r\n * @private\r\n */\n  var _clientDestroy = function() {\n    this.unclip();\n    this.off();\n    delete _clientMeta[this.id];\n  };\n  /**\r\n * Inspect an Event to see if the Client (`this`) should honor it for emission.\r\n * @private\r\n */\n  var _clientShouldEmit = function(event) {\n    if (!(event && event.type)) {\n      return false;\n    }\n    if (event.client && event.client !== this) {\n      return false;\n    }\n    var clippedEls = _clientMeta[this.id] && _clientMeta[this.id].elements;\n    var hasClippedEls = !!clippedEls && clippedEls.length > 0;\n    var goodTarget = !event.target || hasClippedEls && _inArray(event.target, clippedEls) !== -1;\n    var goodRelTarget = event.relatedTarget && hasClippedEls && _inArray(event.relatedTarget, clippedEls) !== -1;\n    var goodClient = event.client && event.client === this;\n    if (!(goodTarget || goodRelTarget || goodClient)) {\n      return false;\n    }\n    return true;\n  };\n  /**\r\n * Handle the actual dispatching of events to a client instance.\r\n *\r\n * @returns `this`\r\n * @private\r\n */\n  var _clientDispatchCallbacks = function(event) {\n    if (!(typeof event === \"object\" && event && event.type)) {\n      return;\n    }\n    var async = _shouldPerformAsync(event);\n    var wildcardTypeHandlers = _clientMeta[this.id] && _clientMeta[this.id].handlers[\"*\"] || [];\n    var specificTypeHandlers = _clientMeta[this.id] && _clientMeta[this.id].handlers[event.type] || [];\n    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);\n    if (handlers && handlers.length) {\n      var i, len, func, context, eventCopy, originalContext = this;\n      for (i = 0, len = handlers.length; i < len; i++) {\n        func = handlers[i];\n        context = originalContext;\n        if (typeof func === \"string\" && typeof _window[func] === \"function\") {\n          func = _window[func];\n        }\n        if (typeof func === \"object\" && func && typeof func.handleEvent === \"function\") {\n          context = func;\n          func = func.handleEvent;\n        }\n        if (typeof func === \"function\") {\n          eventCopy = _extend({}, event);\n          _dispatchCallback(func, context, [ eventCopy ], async);\n        }\n      }\n    }\n    return this;\n  };\n  /**\r\n * Prepares the elements for clipping/unclipping.\r\n *\r\n * @returns An Array of elements.\r\n * @private\r\n */\n  var _prepClip = function(elements) {\n    if (typeof elements === \"string\") {\n      elements = [];\n    }\n    return typeof elements.length !== \"number\" ? [ elements ] : elements;\n  };\n  /**\r\n * Add an event listener to a DOM element (because IE<9 sucks).\r\n *\r\n * @returns The element.\r\n * @private\r\n */\n  var _addEventHandler = function(element, method, func) {\n    if (!element || element.nodeType !== 1) {\n      return element;\n    }\n    if (element.addEventListener) {\n      element.addEventListener(method, func, false);\n    } else if (element.attachEvent) {\n      element.attachEvent(\"on\" + method, func);\n    }\n    return element;\n  };\n  /**\r\n * Remove an event listener from a DOM element (because IE<9 sucks).\r\n *\r\n * @returns The element.\r\n * @private\r\n */\n  var _removeEventHandler = function(element, method, func) {\n    if (!element || element.nodeType !== 1) {\n      return element;\n    }\n    if (element.removeEventListener) {\n      element.removeEventListener(method, func, false);\n    } else if (element.detachEvent) {\n      element.detachEvent(\"on\" + method, func);\n    }\n    return element;\n  };\n  /**\r\n * Add a `mouseover` handler function for a clipped element.\r\n *\r\n * @returns `undefined`\r\n * @private\r\n */\n  var _addMouseHandlers = function(element) {\n    if (!(element && element.nodeType === 1)) {\n      return;\n    }\n    var _elementMouseOver = function(event) {\n      if (!(event || _window.event)) {\n        return;\n      }\n      ClipAndFile.activate(element);\n    };\n    _addEventHandler(element, \"mouseover\", _elementMouseOver);\n    _mouseHandlers[element.cafClippingId] = {\n      mouseover: _elementMouseOver\n    };\n  };\n  /**\r\n * Remove a `mouseover` handler function for a clipped element.\r\n *\r\n * @returns `undefined`\r\n * @private\r\n */\n  var _removeMouseHandlers = function(element) {\n    if (!(element && element.nodeType === 1)) {\n      return;\n    }\n    var mouseHandlers = _mouseHandlers[element.cafClippingId];\n    if (!(typeof mouseHandlers === \"object\" && mouseHandlers)) {\n      return;\n    }\n    if (typeof mouseHandlers.mouseover === \"function\") {\n      _removeEventHandler(element, \"mouseover\", mouseHandlers.mouseover);\n    }\n    delete _mouseHandlers[element.cafClippingId];\n  };\n  /**\r\n * Creates a new ClipAndFile client instance.\r\n * Optionally, auto-`clip` an element or collection of elements.\r\n *\r\n * @constructor\r\n */\n  ClipAndFile._createClient = function() {\n    _clientConstructor.apply(this, _args(arguments));\n  };\n  /**\r\n * Register an event listener to the client.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.prototype.on = function() {\n    return _clientOn.apply(this, _args(arguments));\n  };\n  /**\r\n * Unregister an event handler from the client.\r\n * If no `listener` function/object is provided, it will unregister all handlers for the provided `eventType`.\r\n * If no `eventType` is provided, it will unregister all handlers for every event type.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.prototype.off = function() {\n    return _clientOff.apply(this, _args(arguments));\n  };\n  /**\r\n * Retrieve event listeners for an `eventType` from the client.\r\n * If no `eventType` is provided, it will retrieve all listeners for every event type.\r\n *\r\n * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`\r\n */\n  ClipAndFile.prototype.handlers = function() {\n    return _clientListeners.apply(this, _args(arguments));\n  };\n  /**\r\n * Event emission receiver from the Flash object for this client's registered JavaScript event listeners.\r\n *\r\n * @returns For the \"copy\" event, returns the Flash-friendly \"clipData\" object; otherwise `undefined`.\r\n */\n  ClipAndFile.prototype.emit = function() {\n    return _clientEmit.apply(this, _args(arguments));\n  };\n  /**\r\n * Register clipboard actions for new element(s) to the client.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.prototype.clip = function() {\n    return _clientClip.apply(this, _args(arguments));\n  };\n  /**\r\n * Unregister the clipboard actions of previously registered element(s) on the page.\r\n * If no elements are provided, ALL registered elements will be unregistered.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.prototype.unclip = function() {\n    return _clientUnclip.apply(this, _args(arguments));\n  };\n  /**\r\n * Get all of the elements to which this client is clipped.\r\n *\r\n * @returns array of clipped elements\r\n */\n  ClipAndFile.prototype.elements = function() {\n    return _clientElements.apply(this, _args(arguments));\n  };\n  /**\r\n * Self-destruct and clean up everything for a single client.\r\n * This will NOT destroy the embedded Flash object.\r\n *\r\n * @returns `undefined`\r\n */\n  ClipAndFile.prototype.destroy = function() {\n    return _clientDestroy.apply(this, _args(arguments));\n  };\n  /**\r\n * Stores the pending plain text to inject into the clipboard.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.prototype.setText = function(text) {\n    ClipAndFile.setData(\"text/plain\", text);\n    return this;\n  };\n  /**\r\n * Stores the pending HTML text to inject into the clipboard.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.prototype.setHtml = function(html) {\n    ClipAndFile.setData(\"text/html\", html);\n    return this;\n  };\n  /**\r\n * Stores the pending rich text (RTF) to inject into the clipboard.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.prototype.setRichText = function(richText) {\n    ClipAndFile.setData(\"application/rtf\", richText);\n    return this;\n  };\n  /**\r\n * Stores the pending data to inject into the clipboard.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.prototype.setData = function() {\n    ClipAndFile.setData.apply(this, _args(arguments));\n    return this;\n  };\n  /**\r\n * Stores the pending data to save as a file.  Call only once.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.prototype.setFile = function() {\n    ClipAndFile.setFile.apply(this, _args(arguments));\n    return this;\n  };\n  /**\r\n * Clears the pending data to inject into the clipboard.\r\n * If no `format` is provided, all pending data formats will be cleared.\r\n *\r\n * @returns `this`\r\n */\n  ClipAndFile.prototype.clearData = function() {\n    ClipAndFile.clearData.apply(this, _args(arguments));\n    return this;\n  };\n  if (typeof define === \"function\" && define.amd) {\n    define(function() {\n      return ClipAndFile;\n    });\n  } else if (typeof module === \"object\" && module && typeof module.exports === \"object\" && module.exports) {\n    module.exports = ClipAndFile;\n  } else {\n    window.ClipAndFile = ClipAndFile;\n  }\n})(function() {\n  return this;\n}());"]}